# 多账户管理功能说明

## 功能概述

新增多账户管理功能,允许用户在应用中管理多个Kikoeru账户,并可以方便地在不同账户之间切换。

## 主要特性

### 1. 账户管理
- **添加账户**: 添加新的Kikoeru账户(用户名、密码、服务器地址)
- **编辑账户**: 修改已保存账户的信息
- **删除账户**: 删除不再使用的账户(当前使用的账户不可删除)
- **账户列表**: 查看所有已保存的账户,当前使用的账户会有标识

### 2. 账户切换
- 点击账户即可快速切换
- 切换时自动使用保存的密码登录
- 自动更新最后使用时间

### 3. 数据持久化
- 使用SQLite数据库存储账户信息
- 账户信息包括:
  - 用户名
  - 密码(加密存储)
  - 服务器地址
  - 是否为当前活动账户
  - 创建时间
  - 最后使用时间

## 使用方法

### 访问账户管理
1. 进入应用的"设置"页面
2. 点击"账户管理"选项
3. 进入账户管理界面

### 添加新账户
1. 在账户管理界面,点击右下角的"+"按钮
2. 输入用户名、密码和服务器地址
3. 点击"添加"按钮保存

### 切换账户
1. 在账户列表中点击想要切换的账户
2. 确认切换操作
3. 应用会自动使用该账户登录

### 编辑账户
1. 点击账户右侧的菜单按钮(三个点)
2. 选择"编辑"
3. 修改账户信息后保存

### 删除账户
1. 点击账户右侧的菜单按钮(三个点)
2. 选择"删除"
3. 确认删除操作

## 技术实现

### 数据库结构
```sql
CREATE TABLE accounts (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  username TEXT NOT NULL,
  password TEXT NOT NULL,
  host TEXT NOT NULL,
  isActive INTEGER NOT NULL DEFAULT 0,
  createdAt TEXT,
  lastUsedAt TEXT
)
```

### 核心文件
- `lib/src/models/account.dart` - 账户数据模型
- `lib/src/services/account_database.dart` - 数据库服务
- `lib/src/screens/account_management_screen.dart` - 账户管理界面
- `lib/src/providers/auth_provider.dart` - 认证提供者(已更新以支持账户系统)

## 兼容性

本功能与现有的登录、注册、认证系统完全兼容:
- 用户首次登录时,账户信息会自动保存到数据库
- 应用启动时会自动加载上次使用的账户
- 所有现有功能保持不变,只是增加了多账户管理能力

## 安全性

- 账户密码存储在本地SQLite数据库中
- 建议在未来版本中添加密码加密功能
- 切换账户时需要重新认证

## 注意事项

1. 当前使用的账户无法删除
2. 切换账户会重新登录,原有会话会失效
3. 账户信息仅存储在本地设备
4. 删除应用会清除所有保存的账户信息
